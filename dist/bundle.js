!function(t){var i={};function e(o){if(i[o])return i[o].exports;var s=i[o]={i:o,l:!1,exports:{}};return t[o].call(s.exports,s,s.exports,e),s.l=!0,s.exports}e.m=t,e.c=i,e.d=function(t,i,o){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var s in t)e.d(o,s,function(i){return t[i]}.bind(null,s));return o},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=0)}([function(t,i,e){e(2),t.exports=e(1)},function(t,i){},function(t,i,e){"use strict";e.r(i);const o=5;let s=[],r=0;for(let t=0;t<o;t++)s.push(new Audio("sounds/bubble_pop.mp3"));function n(){return document.getElementById("game-display")}class a{constructor(t,i,e=[0,0],o=!1,s=[0,0]){this.radius=t,this.mass=Math.pow(t,3),this.position=i,this.velocity=e,this.force=[0,0],this.isPlayer=o,this.pairwiseForce=s,this.moving=!1,this.blobDiv=document.createElement("div"),this.blobDiv.classList.add("blob"),n().appendChild(this.blobDiv),o&&(this.blobDiv.id="player")}update(){this.move(),gameState.drag&&this.viscosity(),this.accelerate(),gameState.borderTeleport&&this.teleport(),gameState.borderBounce&&this.borderBounce(),this.updateDiv(),(gameState.gravity||gameState.repulsion)&&(this.pairwiseForce=[0,0])}updatePlayerForce(){keyState.up?keyState.left?this.force=[-diagonal,diagonal]:keyState.right?this.force=[diagonal,diagonal]:this.force=[0,1]:keyState.down?keyState.left?this.force=[-diagonal,-diagonal]:keyState.right?this.force=[diagonal,-diagonal]:this.force=[0,-1]:keyState.right?this.force=[1,0]:keyState.left?this.force=[-1,0]:this.force=[0,0]}blobWander(){this.moving&&Math.random()>.95&&this.newRandomDirection(),Math.random()>.993&&this.toggleMoving()}newRandomDirection(){let t=2*Math.random()*Math.PI,i=Math.random();this.force[0]=Math.cos(t)*i,this.force[1]=Math.sin(t)*i}toggleMoving(){this.moving=!this.moving}getAbsVel(){return Math.sqrt(Math.pow(this.velocity[0],2)+Math.pow(this.velocity[1],2))}updateDiv(){this.blobDiv.style.left=this.position[0]-this.radius+"px",this.blobDiv.style.bottom=this.position[1]-this.radius+"px",this.blobDiv.style.height=2*this.radius+"px",this.blobDiv.style.width=2*this.radius+"px"}move(){this.position[0]+=this.velocity[0],this.position[1]+=this.velocity[1]}viscosity(){this.velocity[0]*=1-drag*Math.sqrt(this.radius)*Math.abs(this.velocity[0]),this.velocity[1]*=1-drag*Math.sqrt(this.radius)*Math.abs(this.velocity[1])}hunger(){this.radius>minSize&&(this.radius*=1-appetite)}getRadius(){return this.radius}getMass(){return this.mass}getVel(){return this.velocity}getPos(){return this.position}getForce(){return this.force}setForce(t){this.force=t}adjustVelocityBy(t){this.velocity[0]+=t[0],this.velocity[1]+=t[1]}adjustPositionBy(t){this.position[0]+=t[0],this.position[1]+=t[1]}accelerate(){gameState.drag&&(this.velocity[0]+=speedUp*this.force[0],this.velocity[1]+=speedUp*this.force[1]),(gameState.gravity||gameState.repulsion)&&(this.velocity[0]+=this.pairwiseForce[0]/this.mass,this.velocity[1]+=this.pairwiseForce[1]/this.mass)}borderBounce(){this.position[0]<-this.radius?this.velocity[0]-=borderElasticity*(this.position[0]+this.radius):this.position[0]>this.radius+windowSize.horizontal&&(this.velocity[0]-=borderElasticity*(this.position[0]-this.radius-windowSize.horizontal)),this.position[1]<-this.radius?this.velocity[1]-=borderElasticity*(this.position[1]+this.radius):this.position[1]>this.radius+windowSize.vertical&&(this.velocity[1]-=borderElasticity*(this.position[1]-this.radius-windowSize.vertical))}teleport(){this.position[0]=(this.position[0]+windowSize.horizontal)%windowSize.horizontal,this.position[1]=(this.position[1]+windowSize.vertical)%windowSize.vertical}deleteDiv(){this.blobDiv.parentNode.removeChild(this.blobDiv)}biggerThan(t){return this.radius>=t.radius}consume(t){let i=Math.pow(t.radius,3)/(Math.pow(this.radius,3)+Math.pow(t.radius,3)),e=[this.position[0]+(t.position[0]-this.position[0])*i,this.position[1]+(t.position[1]-this.position[1])*i],n=[this.velocity[0]+(t.velocity[0]-this.velocity[0])*i,this.velocity[1]+(t.velocity[1]-this.velocity[1])*i],h=Math.pow(Math.pow(this.radius,3)+Math.pow(t.radius,3),1/3);return t.deleteDiv(),this.deleteDiv(),s[r=(r+1)%o].play(),new a(h,e,n,this===player)}setOpacity(t){this.blobDiv.style.opacity=t}static getDistance(t,i,e){var o=Math.sqrt(Math.pow(t.position[0]-i.position[0],2)+Math.pow(t.position[1]-i.position[1],2));return e?o:o-(t.radius+i.radius)}static pairwiseInteraction(t,i){if(gameState.gravity||gameState.repulsion){let e=a.getDistance(t,i,!0),o=pairwiseForceStrength*t.mass*i.mass/Math.pow(e,2),s=o*(t.position[0]-i.position[0])/e,r=o*(t.position[1]-i.position[1])/e;t.pairwiseForce[0]-=s,t.pairwiseForce[1]-=r,i.pairwiseForce[0]+=s,i.pairwiseForce[1]+=r}}}let h,l,d=[],c={horizontal:0,vertical:0},u={left:!1,right:!1,down:!1,up:!1},p={gravity:!1,repulsion:!1,drag:!0,borderBounce:!0,borderTeleport:!1},y=0,g=200,v=10,f=[50,50];Math.sqrt(2);const b=10,m=.5,w=-.5,M=50;function S(){document.getElementById("instructions").classList.toggle("hidden")}function k(){l=null,S(),d.forEach(t=>{t.setOpacity(1)})}function C(t=.8*v*Math.pow(5,Math.pow(Math.random(),2)),i=function(){let t,i=4*Math.random();t=i<1?[0,c.vertical*i]:i<2?[c.horizontal*(i-1),0]:i<3?[c.horizontal,c.vertical*(i-2)]:[c.horizontal*(i-3),0];return t}(),e=[4*Math.random()-2,4*Math.random()-2]){let o=new a(t,i,e,!1);d.push(o)}function D(){let t=n().getBoundingClientRect();c.horizontal=t.width,c.vertical=t.height,f=[c.horizontal/2,c.vertical/2]}function z(t){39===t.keyCode?u.right=!0:37===t.keyCode?u.left=!0:38===t.keyCode?u.up=!0:40===t.keyCode?u.down=!0:71===t.keyCode?(p.gravity=!0,p.repulsion=!1,y=m):82===t.keyCode?(p.gravity=!1,p.repulsion=!0,y=w):70===t.keyCode&&(p.drag=!1),l&&l.updatePlayerForce()}function F(t){39===t.keyCode?u.right=!1:37===t.keyCode?u.left=!1:38===t.keyCode?u.up=!1:40===t.keyCode?u.down=!1:71===t.keyCode?(p.gravity=!1,y=0):82===t.keyCode?(p.repulsion=!1,y=0):70===t.keyCode?p.drag=!0:84===t.keyCode?(p.borderTeleport=!p.borderTeleport,p.borderTeleport&&(p.borderBounce=!1)):66===t.keyCode?(p.borderBounce=!p.borderBounce,p.borderBounce&&(p.borderTeleport=!1)):90===t.keyCode?function(){let t=[0,0],i=[0,0],e=0,o=l?d.concat([l]):d;for(let s=0;s<o.length;s++){let r=o[s].getMass(),n=o[s].getVel(),a=o[s].getPos();e+=r,t[0]+=n[0]*r,t[1]+=n[1]*r,i[0]+=a[0]*r,i[1]+=a[1]*r}let s=[-t[0]/e,-t[1]/e],r=[f[0]-i[0]/e,f[1]-i[1]/e];for(let t=0;t<o.length;t++)o[t].adjustVelocityBy(s),o[t].adjustPositionBy(r)}():65===t.keyCode&&C(),l&&l.updatePlayerForce()}function B(t){32===t.keyCode&&(l||(l=new a(v,f.slice(),[0,0],!0),S()))}window.onload=function(){D(),document.addEventListener("keydown",z,!1),document.addEventListener("keyup",F,!1),document.addEventListener("keypress",B,!1),window.addEventListener("resize",D,!1),S(),function(){d.length<b&&Math.random()>.99&&C(),l&&(l.update(),g=10*v+5*l.radius);for(var t=[],i=0;i<d.length;i++)if(d[i]){if(d[i].blobWander(),d[i].update(),l){let t=a.getDistance(l,d[i],!1);if(t<0){if(l.biggerThan(d[i])){var e=l.getForce();(l=l.consume(d[i])).setForce(e),d[i]=null;continue}d[i]=d[i].consume(l),k()}else d[i].setOpacity(Math.max(1-t/g,0)),a.pairwiseInteraction(l,d[i])}for(var o=i+1;o<d.length;o++)d[o]&&(a.getDistance(d[i],d[o],!1)<0?(d[i].biggerThan(d[o])?d[i]=d[i].consume(d[o]):d[i]=d[o].consume(d[i]),d[o]=null):a.pairwiseInteraction(d[i],d[o]));t.push(d[i])}d=t,h=setTimeout("iteration()",1e3/M)}()}}]);